(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(t,e,a){a("bUC5"),t.exports=a("pyCd")},"6OQf":function(t,e,a){(t.exports=a("I1BE")(!1)).push([t.i,".v-application--is-ltr .v-tabs-bar.v-tabs-bar--is-mobile:not(.v-tabs-bar--show-arrows) > .v-slide-group__wrapper > .v-tabs-bar__content > .v-tabs-slider-wrapper + .v-tab {\n  margin-left: 0;\n}\n.v-snack__content b {\n  padding-right: 10px;\n}",""])},DWEW:function(t,e,a){"use strict";var n=a("dQSP");a.n(n).a},bUC5:function(t,e,a){"use strict";a.r(e);var n=a("XuX8"),s=a.n(n),i=a("8wkQ"),o=a("VgeV");a("U2NJ");s.a.use(i.a,{directives:{Ripple:o.a}});var r=new i.a({theme:{themes:{light:{primary:"#2374AB",secondary:"#303633",accent:"#4DCCBD"}}},icons:{iconfont:"mdi"}}),c=a("jE9Z");s.a.use(c.a);var l=new c.a({routes:[{path:"/",name:"Home",component:function(){return Promise.all([a.e(0),a.e(3)]).then(a.bind(null,"VUzb"))}},{path:"/map",name:"Map",component:function(){return Promise.all([a.e(0),a.e(4)]).then(a.bind(null,"t/v5"))}},{path:"/table",name:"Table",component:function(){return Promise.all([a.e(0),a.e(6)]).then(a.bind(null,"3Wc7"))}},{path:"/settings",name:"Settings",component:function(){return Promise.all([a.e(0),a.e(5)]).then(a.bind(null,"CORB"))}}]}),u=a("L2JU"),v={namespaced:!0,state:{data:[],counts:[]},mutations:{setData:function(t,e){t.data=e},setCount:function(t,e){t.counts=t.counts.concat([e])},emptyCounts:function(t){t.counts=[]}}},p={namespaced:!0,state:{data:[],selection:{id:null}},mutations:{setData:function(t,e){t.data=t.data.concat(e)},setSelection:function(t,e){t.selection=e},emptyData:function(t){t.data=[],t.selection={id:null}}}},d={namespaced:!0,state:{activeAgencies:["stm"],autoRefresh:!1,defaultPath:"/",configurationDone:!1},mutations:{setActiveAgencies:function(t,e){t.activeAgencies=e},setAutoRefresh:function(t,e){t.autoRefresh=e},setDefaultPath:function(t,e){t.defaultPath=e},setConfigurationDone:function(t,e){t.configurationDone=e}}},g=a("v6lo");s.a.use(u.a);var f=new g.a({storage:window.localStorage,reducer:function(t){return{settings:t.settings}}}),h=new u.a.Store({modules:{agencies:v,vehicles:p,settings:d},plugins:[f.plugin]}),m=a("qSUR"),b=a("dJbz"),_=a("QNyc"),A=a("Kn9U"),V=a("L6Q5"),C=a("/ldL"),k=a("caNO"),D=a("p1ug"),w=a("jjY0"),y=a("LbRV"),S=a("gzZi"),x=a("vDqi"),R=a.n(x),T=a("FpqX"),$=a("foXO"),L=a("nFRB"),P=a("VqT0"),B=a("zn5u"),M=a("5Rb5"),I=a("D9m0"),E=a("Yq0q"),O=a("iGBT"),q=a("2hOt"),z=a("GADD"),Q=a("rHzn"),U=a("XSMC"),W=a("gnBG"),G=a("Ey0z"),H=a("tz1R"),j=a("B5h7"),J=a("Q6Zl"),X=a("Z7Yp"),Y={components:{VDialog:T.a,VStepper:$.a,VStepperHeader:L.a,VStepperStep:P.a,VDivider:B.a,VStepperItems:L.b,VStepperContent:M.a,VRow:I.a,VCol:E.a,VBtn:S.a,VList:O.a,VListItem:q.a,VListItemAction:z.a,VCheckbox:Q.a,VListItemContent:U.a,VListItemTitle:U.b,VListItemAvatar:W.a,VIcon:G.a,VSwitch:H.a,VAlert:j.a,VRadioGroup:J.a,VRadio:X.a},data:function(){return{stepper:0,dialog:!0,settingsLang:"en"}},methods:{loadAgencies:function(){var t=this;R.a.get("/agencies").then(function(e){return t.loadedAgencies=e.data.data})},setConfigurationAsDone:function(){this.$emit("configurationDone")}},computed:{routes:function(){return this.$router.options.routes},loadedAgencies:{get:function(){return this.$store.state.agencies.data},set:function(t){this.$store.commit("agencies/setData",t)}},settingsActiveAgencies:{get:function(){return this.$store.state.settings.activeAgencies},set:function(t){this.$store.commit("settings/setActiveAgencies",t)}},settingsAutoRefresh:{get:function(){return this.$store.state.settings.autoRefresh},set:function(t){this.$store.commit("settings/setAutoRefresh",t)}},settingsDefaultPath:{get:function(){return this.$store.state.settings.defaultPath},set:function(t){this.$store.commit("settings/setDefaultPath",t)}}},watch:{settingsLang:function(t){this.$i18n.locale=t}}},N=a("KHd+"),Z=Object(N.a)(Y,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{persistent:""},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-stepper",{model:{value:t.stepper,callback:function(e){t.stepper=e},expression:"stepper"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{complete:t.stepper>1,step:"1"}},[t._v("Language\n            ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.stepper>2,step:"2"}},[t._v("Conditions\n            ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.stepper>3,step:"3"}},[t._v("Agencies\n            ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.stepper>4,step:"4"}},[t._v("Settings\n            ")])],1),t._v(" "),a("v-stepper-items",[a("v-stepper-content",{attrs:{step:"1"}},[a("v-row",[a("v-col",{attrs:{cols:"12",md:"4"}},[a("img",{attrs:{src:"/svg/road-and-rail.svg",alt:"Road rail and bus"}})]),t._v(" "),a("v-col",{attrs:{cols:"12",md:"8"}},[a("div",{staticClass:"display-1 mb-2"},[t._v("Welcome to Montreal Transit Tracker")]),t._v(" "),a("div",{staticClass:"title mb-3"},[t._v("Version 2.0 - This is a beta version, please report any bug on\n                            "),a("a",{attrs:{href:"https://cptdb.ca/topic/19090-montreal-realtime-transit-viewer/"}},[t._v("CPTDB")]),t._v(" or\n                            "),a("a",{attrs:{href:"https://github.com/felixinx/montreal-transit-tracker/issues"}},[t._v("GitHub")])]),t._v(" "),a("v-btn",{staticClass:"float-right",attrs:{color:"accent"},on:{click:function(e){t.stepper=2}}},[t._v("\n                            Continue\n                        ")])],1)],1)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[a("p",{staticClass:"title"},[t._v("Please read the following conditions before using the application:")]),t._v(" "),a("div",[a("p",{staticClass:"md-body-1"},[t._v("The data on this website is given as is and should not be used as a public transport timetable. The accuracy and reliability of the data is not guaranteed.")]),t._v(" "),a("p",{staticClass:"md-body-2"},[t._v("Montreal Transit Tracker, Société de transport de Montréal, Société de transport de Laval and exo are not responsible for the use of the data presented on this site.")]),t._v(" "),a("p",{staticClass:"md-body-1"},[t._v("The data comes from the following agencies:")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"http://stm.info"}},[t._v("Société de transport de Montréal (STM)")])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://stl.laval.qc.ca"}},[t._v("Société de transport de Laval (STL)")])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://exo.quebec"}},[t._v("exo")]),t._v(" (including exo buses, exo trains and Réseau de transport de Longueuil buses)")])]),t._v(" "),a("p",[t._v("The above data are all available under the "),a("a",{attrs:{href:"https://creativecommons.org/licenses/by/4.0/deed.en"}},[t._v("Creative Common 4.0 CC BY")]),t._v(" license.")]),t._v(" "),a("p",{staticClass:"md-body-2"},[t._v("Google Analytics is used for statistical purposes. During beta versions, when an error occurs, some data will be sent to Bugsnap to help resolve errors and bugs.")])]),t._v(" "),a("v-btn",{attrs:{text:"",icon:"",color:"secondary"},on:{click:function(e){t.stepper=1}}},[a("v-icon",[t._v("mdi-arrow-left")])],1),t._v(" "),a("v-btn",{staticClass:"float-right",attrs:{color:"accent"},on:{click:function(e){t.stepper=3,t.loadAgencies()}}},[t._v("\n                    I agree, continue\n                ")])],1),t._v(" "),a("v-stepper-content",{attrs:{step:"3"}},[a("p",{staticClass:"title"},[t._v("Choose the agencies you want to see:")]),t._v(" "),a("v-list",t._l(t.loadedAgencies,function(e){return a("v-list-item",{key:e.id},[a("v-list-item-action",[a("v-checkbox",{attrs:{value:e.slug},model:{value:t.settingsActiveAgencies,callback:function(e){t.settingsActiveAgencies=e},expression:"settingsActiveAgencies"}})],1),t._v(" "),a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(e.name))])],1),t._v(" "),a("v-list-item-avatar",{style:{backgroundColor:e.color,borderColor:e.text_color}},[a("v-icon",{style:{color:e.text_color}},[t._v("mdi-"+t._s(e.vehicles_type))])],1)],1)}),1),t._v(" "),a("v-btn",{attrs:{text:"",icon:"",color:"secondary"},on:{click:function(e){t.stepper=2}}},[a("v-icon",[t._v("mdi-arrow-left")])],1),t._v(" "),a("v-btn",{staticClass:"float-right",attrs:{color:"accent"},on:{click:function(e){t.stepper=4}}},[t._v("\n                    Continue\n                ")])],1),t._v(" "),a("v-stepper-content",{staticClass:"pa-3",attrs:{step:"4"}},[a("div",{staticClass:"pa-3"},[a("p",{staticClass:"title"},[t._v("Settings")]),t._v(" "),a("v-switch",{attrs:{label:"Auto refresh every minute"},model:{value:t.settingsAutoRefresh,callback:function(e){t.settingsAutoRefresh=e},expression:"settingsAutoRefresh"}}),t._v(" "),a("v-alert",{attrs:{dense:"",border:"left",type:"warning"}},[t._v("\n                        Auto refresh is coming soon!\n                    ")]),t._v(" "),a("v-divider"),t._v(" "),a("p",{staticClass:"subtitle-1"},[t._v("Default tab on opening")]),t._v(" "),a("v-radio-group",{model:{value:t.settingsDefaultPath,callback:function(e){t.settingsDefaultPath=e},expression:"settingsDefaultPath"}},t._l(t.routes,function(t){return a("v-radio",{key:t.path,attrs:{value:t.path,label:t.name}})}),1),t._v(" "),a("v-btn",{attrs:{icon:"",text:"",color:"secondary"},on:{click:function(e){t.stepper=3}}},[a("v-icon",[t._v("mdi-arrow-left")])],1),t._v(" "),a("v-btn",{staticClass:"float-right",attrs:{color:"accent"},on:{click:t.setConfigurationAsDone}},[t._v("\n                        Done\n                    ")])],1)])],1)],1)],1)},[],!1,null,"79cbaecc",null).exports,F=a("vzxw"),K=a.n(F);R.a.defaults.baseURL="http://127.0.0.1:8000/api";var tt={name:"app",components:{VApp:b.a,VAppBar:_.a,VToolbarTitle:A.a,VSpacer:V.a,VTabs:C.a,VTab:k.a,VContent:D.a,VProgressLinear:w.a,VSnackbar:y.a,VBtn:S.a,DialogConfiguration:Z},data:function(){return{menuVisible:!1,appReady:!1,oldAgenciesSnackbarVisible:!1,oldAgenciesSnackbarTimeout:1e4,updateSnackbarVisible:!1}},mounted:function(){this.settings.configurationDone&&this.loadData(),this.settings.autoRefresh&&this.listenToAutoRefresh()},computed:{settings:function(){return this.$store.state.settings},agencies:{get:function(){return this.$store.state.agencies.data},set:function(t){this.$store.commit("agencies/setData",t)}}},methods:{setConfigurationAsDone:function(){this.$store.commit("settings/setConfigurationDone",!0),this.loadData()},loadData:function(){var t=this,e=Math.floor(Date.now()/1e3);console.log("Loading at "+e),this.$router.push(this.$store.state.settings.defaultPath),R.a.get("/agencies").then(function(e){return t.agencies=e.data.data}),K()(this.settings.activeAgencies).each(function(a){console.log("Loading vehicles from "+a),R.a.get("/vehicles/"+a).then(function(n){return t.loadVehicles(e,n,a)}).catch(function(e){403===e.response.status&&t.removeAgency(a)})}),this.appReady=!0},loadVehicles:function(t,e,a){var n=t-e.data.timestamp;this.$store.commit("vehicles/setData",e.data.data),this.$store.commit("agencies/setCount",{agency:a,count:e.data.count,diff:n}),n>300&&this.showSnackbar()},showSnackbar:function(){this.oldAgenciesSnackbarTimeout+=1e3,this.oldAgenciesSnackbarVisible=!0},removeAgency:function(t){var e=this.settings.activeAgencies;e.splice(e.indexOf(t),1),this.$store.commit("settings/setActiveAgencies",e)},listenToAutoRefresh:function(){},refreshData:function(){var t=this,e=Math.floor(Date.now()/1e3);console.log("Reloading at "+e),this.$store.commit("vehicles/emptyData"),this.$store.commit("agencies/emptyCounts"),K()(this.settings.activeAgencies).each(function(a){console.log("Reloading vehicles from "+a),R.a.get("/vehicles/"+a).then(function(n){return t.loadVehicles(e,n,a)}).catch(function(e){403===e.response.status&&t.removeAgency(a)})}),this.updateSnackbarVisible=!0}}},et=(a("DWEW"),Object(N.a)(tt,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("v-app",{attrs:{id:"mtltt"}},[a("v-app-bar",{attrs:{app:"",absolute:"",color:"primary",dark:""},scopedSlots:t._u([{key:"extension",fn:function(){return[a("v-tabs",{attrs:{"fixed-tabs":"","background-color":"transparent"}},[a("v-tab",{attrs:{to:"/"}},[t._v("Home")]),t._v(" "),a("v-tab",{attrs:{to:"/map"}},[t._v("Map")]),t._v(" "),a("v-tab",{attrs:{to:"/table"}},[t._v("Table")]),t._v(" "),a("v-tab",{attrs:{to:"/settings"}},[t._v("Settings")])],1)]},proxy:!0}])},[a("v-toolbar-title",[t._v("Montréal Transit Tracker")]),t._v(" "),a("v-spacer")],1),t._v(" "),a("v-content",[t.settings.configurationDone?t._e():a("dialog-configuration",{on:{configurationDone:t.setConfigurationAsDone}}),t._v(" "),t.appReady?t._e():a("v-progress-linear",{attrs:{value:0,color:"accent",indeterminate:""}}),t._v(" "),t.appReady&&t.settings.configurationDone?a("router-view",{on:{"refresh-vehicles":t.refreshData}}):t._e(),t._v(" "),a("v-snackbar",{attrs:{timeout:t.oldAgenciesSnackbarTimeout},model:{value:t.oldAgenciesSnackbarVisible,callback:function(e){t.oldAgenciesSnackbarVisible=e},expression:"oldAgenciesSnackbarVisible"}},[a("b",[t._v("Warning!")]),t._v(" "),a("span",[t._v("Data from some agencies are outdated and should be used with caution.")]),t._v(" "),a("v-btn",{attrs:{color:"accent",text:""},on:{click:function(e){t.oldAgenciesSnackbarVisible=!1}}},[t._v("\n                    Close\n                ")])],1),t._v(" "),a("v-snackbar",{attrs:{timeout:5e3},model:{value:t.updateSnackbarVisible,callback:function(e){t.updateSnackbarVisible=e},expression:"updateSnackbarVisible"}},[a("b",[t._v("Warning!")]),t._v(" "),a("span",[t._v("Data from some agencies are outdated and should be used with caution.")]),t._v(" "),a("v-btn",{attrs:{color:"accent",text:""},on:{click:function(e){t.updateSnackbarVisible=!1}}},[t._v("\n                    Close\n                ")])],1)],1)],1)],1)},[],!1,null,null,null).exports),at=a("NTr2"),nt=a.n(at),st=a("MYFm"),it=a.n(st);nt()("8b0403f91803771a07af0f9d944e2638").use(it.a,s.a),s.a.use(m.a),window.vm=new s.a({el:"#app",vuetify:r,router:l,store:h,render:function(t){return t(et)}}),ga("set","page",l.currentRoute.path),ga("send","pageview"),l.afterEach(function(t,e){ga("set","page",t.path),ga("send","pageview")})},dQSP:function(t,e,a){var n=a("6OQf");"string"==typeof n&&(n=[[t.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(n,s);n.locals&&(t.exports=n.locals)},pyCd:function(t,e){}},[[0,2,0]]]);