(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"22Q3":function(t,e,i){var n=i("mqh1");"string"==typeof n&&(n=[[t.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(n,s);n.locals&&(t.exports=n.locals)},B1eG:function(t,e,i){"use strict";var n=i("22Q3");i.n(n).a},NuS3:function(t,e,i){"use strict";var n=i("ZG2u");i.n(n).a},Un1j:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,".v-btn[data-v-4ffbdfca] {\n  margin-left: 16px;\n}\n.v-btn--icon[data-v-4ffbdfca] {\n  margin-right: 16px;\n}",""])},Ywwm:function(t,e,i){var n=i("Un1j");"string"==typeof n&&(n=[[t.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(n,s);n.locals&&(t.exports=n.locals)},ZG2u:function(t,e,i){var n=i("jMZF");"string"==typeof n&&(n=[[t.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(n,s);n.locals&&(t.exports=n.locals)},jMZF:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,".v-footer[data-v-675858c6] {\n  padding: 0px 16px;\n  min-height: 76px;\n}\n.col[data-v-675858c6] {\n  margin: auto;\n  text-align: center;\n}\n.agency[data-v-675858c6] {\n  text-align: left;\n}\n.trip .route[data-v-675858c6] {\n  padding: 5px;\n  border-radius: 3px;\n  font-size: 14px;\n  text-align: center;\n}\n.trip .second-line[data-v-675858c6] {\n  text-align: center;\n}\n.expand[data-v-675858c6] {\n  text-align: right;\n}\n.bearing[data-v-675858c6] {\n  max-width: 105px;\n}\n.speed[data-v-675858c6] {\n  max-width: 105px;\n}",""])},lbzX:function(t,e,i){"use strict";var n=i("o3/9");i.n(n).a},mqh1:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,"\n#map[data-v-55555f92] {\n    height: calc(100vh - 180px);\n    z-index: 1;\n}\n",""])},"o3/9":function(t,e,i){var n=i("t1B2");"string"==typeof n&&(n=[[t.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(n,s);n.locals&&(t.exports=n.locals)},"t/v5":function(t,e,i){"use strict";i.r(e);var n=i("VTo9"),s=i("D9m0"),a=i("Yq0q"),o=i("gzZi"),c=i("Ey0z"),r={components:{VFooter:n.a,VRow:s.a,VCol:a.a,VBtn:o.a,VIcon:c.a},props:{agency:Object,vehicle:Object},computed:{noVehicle:function(){return null===this.vehicle.id}},filters:{uppercase:function(t){return t.toUpperCase()}}},l=(i("NuS3"),i("KHd+")),v=Object(l.a)(r,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("v-footer",{attrs:{fixed:""}},[t.noVehicle?i("v-row",{attrs:{align:"center",justify:"center"}},[i("v-col",{staticClass:"select"},[t._v("\n                "+t._s(t.$vuetify.lang.t("$vuetify.mapFooter.select"))+"\n            ")])],1):i("v-row",{attrs:{justify:"center"}},[i("v-col",{staticClass:"agency"},[i("span",{staticClass:"d-none d-md-block"},[t._v(t._s(t.agency.name))]),t._v(" "),i("span",{staticClass:"d-md-none"},[t._v(t._s(t._f("uppercase")(t.agency.slug)))])]),t._v(" "),i("v-col",{staticClass:"ref"},[t._v("\n                "+t._s(t.vehicle.ref)+"\n            ")]),t._v(" "),t.vehicle.bearing?i("v-col",{staticClass:"bearing d-none d-md-block"},[i("v-icon",{style:{transform:"rotate("+t.vehicle.bearing+"deg)"}},[t._v("mdi-navigation")])],1):t._e(),t._v(" "),t.vehicle.speed?i("v-col",{staticClass:"speed d-none d-md-block"},[t._v("\n                "+t._s(t.vehicle.speed)+" km/h\n            ")]):t._e(),t._v(" "),i("v-col",{staticClass:"trip"},[i("div",{staticClass:"route",style:{backgroundColor:t.vehicle.trip.color,color:t.vehicle.trip.text_color}},[t._v("\n                    "+t._s(null===t.vehicle.trip.route_short_name?t.vehicle.route:t.vehicle.trip.route_short_name)+"\n                    "),i("span",{staticClass:"d-none d-md-block"},[t._v(t._s(t.vehicle.trip.long_name))])])]),t._v(" "),i("v-col",{staticClass:"expand"},[i("v-btn",{attrs:{text:"",icon:""},on:{click:function(e){return t.$emit("open-sheet")}}},[i("v-icon",[t._v("mdi-chevron-up")])],1)],1)],1)],1)],1)},[],!1,null,"675858c6",null).exports,h=i("KIyo"),p=i("iGBT"),m=i("Oi+f"),d=i("4Mey"),u=i("2hOt"),_=i("NMP6"),f=i("XSMC"),g=i("L6Q5"),b={components:{VBottomSheet:h.a,VBtn:o.a,VIcon:c.a,VList:p.a,VTooltip:m.a,VSubheader:d.a,VListItem:u.a,VListItemIcon:_.a,VListItemTitle:f.b,VSpacer:g.a},data:function(){return{persistent:!1}},props:{agency:Object,vehicle:Object,sheetOpen:Boolean},computed:{sheetModel:{get:function(){return this.sheetOpen},set:function(t){!this.persistent&&this.$emit("close-sheet")}}},methods:{togglePersistent:function(){this.persistent?this.persistent=!1:this.persistent=!0},clickOutsideSheet:function(){this.persistent||this.$emit("close-sheet")}}},y=(i("tP6G"),Object(l.a)(b,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-bottom-sheet",{attrs:{"hide-overlay":"",persistent:t.persistent},model:{value:t.sheetModel,callback:function(e){t.sheetModel=e},expression:"sheetModel"}},[i("v-list",[i("v-tooltip",{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[i("v-btn",t._g({staticClass:"float-right",attrs:{icon:"",color:"secondary"}},n),[t.persistent?i("v-icon",[t._v("mdi-pin-off")]):i("v-icon",[t._v("mdi-pin")])],1)]}}])},[t._v(" "),i("span",[t._v("This feature is currently broken")])]),t._v(" "),i("v-spacer"),t._v(" "),i("v-btn",{staticClass:"float-right",attrs:{outlined:"",color:"accent"},on:{click:function(e){return t.$emit("close-sheet")}}},[i("span",{staticClass:"d-none d-md-block"},[t._v(t._s(t.$vuetify.lang.t("$vuetify.mapBottomSheet.close")))]),t._v(" "),i("v-icon",[t._v("mdi-close")])],1),t._v(" "),i("v-spacer"),t._v(" "),i("v-btn",{staticClass:"float-right",attrs:{outlined:"",color:"red",href:"https://cptdb.ca/wiki/index.php?title=Special%3ASearch&fulltext=Search&search="+t.agency.name+"+"+t.vehicle.ref,target:"_blank"}},[i("span",{staticClass:"d-none d-md-block"},[t._v(t._s(t.$vuetify.lang.t("$vuetify.mapBottomSheet.search")))]),t._v(" "),i("v-icon",[t._v("mdi-open-in-new")])],1),t._v(" "),i("v-subheader",[t._v(t._s(t.$vuetify.lang.t("$vuetify.mapBottomSheet.moreInfo"))+" "+t._s(t.vehicle.ref))]),t._v(" "),t.vehicle.trip.headsign?i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-sign-direction")])],1),t._v(" "),i("v-list-item-title",[i("b",[t._v(t._s(t.$vuetify.lang.t("$vuetify.mapBottomSheet.headsign")))]),t._v(" "+t._s(t.vehicle.trip.headsign))])],1):t._e(),t._v(" "),t.vehicle.gtfs_trip?i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-identifier")])],1),t._v(" "),i("v-list-item-title",[i("b",[t._v(t._s(t.$vuetify.lang.t("$vuetify.mapBottomSheet.tripId")))]),t._v(" "+t._s(t.vehicle.gtfs_trip))])],1):t._e(),t._v(" "),t.vehicle.start?i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-bus-clock")])],1),t._v(" "),i("v-list-item-title",[i("b",[t._v(t._s(t.$vuetify.lang.t("$vuetify.mapBottomSheet.startTime")))]),t._v(" "+t._s(t.vehicle.start))])],1):t._e(),t._v(" "),t.vehicle.status?i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-bus-stop")])],1),t._v(" "),i("v-list-item-title",[i("b",[t._v(t._s(t.$vuetify.lang.t("$vuetify.mapBottomSheet.status")))]),t._v(" "+t._s(1===t.vehicle.status?"STOPPED_AT":"IN_TRANSIT_TO"))])],1):t._e(),t._v(" "),t.vehicle.stop_sequence?i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-timetable")])],1),t._v(" "),i("v-list-item-title",[i("b",[t._v(t._s(t.$vuetify.lang.t("$vuetify.mapBottomSheet.stopSequence")))]),t._v(" "+t._s(t.vehicle.stop_sequence))])],1):t._e(),t._v(" "),t.vehicle.bearing?i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-compass")])],1),t._v(" "),i("v-list-item-title",[i("b",[t._v(t._s(t.$vuetify.lang.t("$vuetify.mapBottomSheet.bearing")))]),t._v("\n                "+t._s(t.vehicle.bearing)+"Â°\n                "),i("v-icon",{style:{transform:"rotate("+t.vehicle.bearing+"deg)"}},[t._v("mdi-navigation")])],1)],1):t._e(),t._v(" "),t.vehicle.speed?i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-speedometer")])],1),t._v(" "),i("v-list-item-title",[i("b",[t._v(t._s(t.$vuetify.lang.t("$vuetify.mapBottomSheet.speed")))]),t._v(" "+t._s(t.vehicle.speed)+" km/h")])],1):t._e(),t._v(" "),t.vehicle.trip.trip_short_name?i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-ticket-confirmation")])],1),t._v(" "),i("v-list-item-title",[i("b",[t._v(t._s(t.$vuetify.lang.t("$vuetify.mapBottomSheet.departureNumber")))]),t._v(" "+t._s(t.vehicle.trip.trip_short_name))])],1):t._e()],1)],1)},[],!1,null,"4ffbdfca",null).exports),x=(i("rG3h"),i("4ZJM")),k=i.n(x),$=i("j5l6"),w=i.n($),C=i("aSns"),V=i.n(C),S={name:"TabMap",components:{MapFooter:v,MapBottomSheet:y},data:function(){return{map:null,sheetOpen:!1}},mounted:function(){k.a.accessToken="pk.eyJ1IjoiZmVsaXhpbngiLCJhIjoiY2lqYzJoMW9vMDA1dnZsa3F3cmZzcWVsciJ9.ZWBQm52vI7RFRwGuoAzwMg",this.map=new k.a.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[-73.5682,45.4997],zoom:11,attributionControl:!1}),this.map.addControl(new k.a.AttributionControl,"top-right"),this.map.addControl(new k.a.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),"top-left"),this.map.addControl(new k.a.NavigationControl({showCompass:!1}),"top-left"),this.putMarkersOnMap(this.markers),this.selectedVehicle.lat&&this.map.flyTo({center:[this.selectedVehicle.lon,this.selectedVehicle.lat],zoom:13})},computed:{vehicles:function(){return this.$store.state.vehicles.data},agencies:function(){return this.$store.state.agencies.data},selectedVehicle:function(){return this.$store.state.vehicles.selection},selectedAgency:function(){return w()(this.agencies).firstWhere("id",this.selectedVehicle.agency_id)},markers:function(){var t=this;return w()(this.vehicles).map(function(e){var i=w()(t.agencies).firstWhere("id",e.agency_id),n=!1;n=t.selectedVehicle.id===e.id;var s=document.createElement("div");s.className=n?"marker-selected":"marker";var a=document.createElement("svg");a.setAttribute("xmlns","http://www.w3.org/2000/svg"),a.setAttribute("viewBox","0 0 24 24");var o=document.createElement("path");o.setAttribute("d","M 12,2 C 8.13,2 5,5.13 5,9 c 0,5.25 7,13 7,13 0,0 7,-7.75 7,-13 0,-3.87 -3.13,-7 -7,-7 z"),o.setAttribute("fill",n?V()(i.color).darken(.3).hsl():i.color),o.setAttribute("stroke",i.text_color),o.setAttribute("stroke-width","0.5"),a.appendChild(o);var c=document.createElement("path");c.setAttribute("d","bus"===i.vehicles_type?"M4 16c0 .88.39 1.67 1 2.22V20c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h8v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1.78c.61-.55 1-1.34 1-2.22V6c0-3.5-3.58-4-8-4s-8 .5-8 4v10zm3.5 1c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14s1.5.67 1.5 1.5S8.33 17 7.5 17zm9 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm1.5-6H6V6h12v5z":"M12 2c-4.42 0-8 .5-8 4v9.5C4 17.43 5.57 19 7.5 19L6 20.5v.5h12v-.5L16.5 19c1.93 0 3.5-1.57 3.5-3.5V6c0-3.5-3.58-4-8-4zM7.5 17c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14s1.5.67 1.5 1.5S8.33 17 7.5 17zm3.5-6H6V6h5v5zm5.5 6c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm1.5-6h-5V6h5v5z"),c.setAttribute("fill",i.text_color),c.setAttribute("transform","translate(7.25 4) scale(0.4 0.4)"),a.appendChild(c),s.innerHTML=a.outerHTML,s.addEventListener("click",function(){t.map.flyTo({center:[e.lon,e.lat]}),t.$store.commit("vehicles/setSelection",e)});var r=new k.a.Marker(s).setLngLat([e.lon,e.lat]);return r.setOffset([0,n?-25:-16]),r}).toArray()}},watch:{markers:{deep:!0,handler:function(t,e){this.putMarkersOnMap(t,e)}}},methods:{putMarkersOnMap:function(t,e){var i=this;e&&w()(e).each(function(t){t.remove()}),w()(t).each(function(t){t.addTo(i.map)})},toggleSheet:function(){this.sheetOpen?this.sheetOpen=!1:this.sheetOpen=!0}}},M=(i("B1eG"),i("lbzX"),Object(l.a)(S,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tab-map"},[i("div",{attrs:{id:"map"}}),t._v(" "),i("map-footer",{attrs:{agency:t.selectedAgency,vehicle:t.selectedVehicle},on:{"open-sheet":function(e){t.sheetOpen=!0}}}),t._v(" "),t.sheetOpen?i("map-bottom-sheet",{attrs:{agency:t.selectedAgency,vehicle:t.selectedVehicle,"sheet-open":t.sheetOpen},on:{"close-sheet":function(e){t.sheetOpen=!1}}}):t._e()],1)},[],!1,null,"55555f92",null));e.default=M.exports},t1B2:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,"\n.md-app-content {\n    padding: 0;\n}\n.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl {\n    margin: 0 0 30px 10px;\n}\n.marker svg {\n    height: 40px;\n    width: 40px;\n}\n.marker-selected svg {\n    height: 60px;\n    width: 60px;\n}\n.marker-selected {\n    z-index: 2;\n}\n.marker {\n    cursor: pointer;\n}\n",""])},tP6G:function(t,e,i){"use strict";var n=i("Ywwm");i.n(n).a}}]);